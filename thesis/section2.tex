%\chapter{Tối ưu hóa}
%Tối ưu hóa là một tác vụ nhằm tìm kiếm cực trị (nhỏ nhất hoặc lớn nhất) cho một (hoặc các) mục tiêu, đồng thời thỏa mãn các ràng buộc nếu có.
%\section{Tối ưu đa mục tiêu}
%Tối ưu đa mục tiêu là tối ưu nhiều mục tiêu cùng một lúc, mà việc cải thiện kết quả của mục tiêu này sẽ làm xấu đi kết quả của mục tiêu khác (các mục tiêu xung đột với nhau). Thông thường, sẽ không tồn tại một lời giải tối ưu duy nhất cho bài toán. Thay vào đó là một tập các lời giải, được gọi là tập Pareto hay tập không bị trị (non-dominated solution ???). Như vậy, so với các bài toán tối ưu đơn mục tiêu, tối ưu đa mục tiêu bao hàm trong đó hai nhiệm vụ với mức độ quan trọng như nhau: tìm kiếm tập Pareto và sử dụng hệ quyết định để lựa chọn một lời giải phù hợp trong tập đó.
%
%
%Hầu hết các vấn đề trong thực tế đều được mô hình hóa lại thành các bài toán đa mục tiêu. Ví dụ như tối thiểu hóa chi phí và tối đa hóa ích lợi khi mua xe, tối thiểu hóa nhiên liệu và tối đa hóa hiệu năng chạy của công cụ. Hay các ứng dụng thực tế sử dụng mạng cảm biến không dây cần đồng thời xét nhiều mục tiêu cùng một lúc như: tối thiểu hóa năng lượng, tối đa hóa thời gian sống, tối thiểu hóa độ nhiễu đều là các vấn đề có thể được mô hình hóa lại dưới dạng một bài toán tối ưu hóa đa mục tiêu.
%
%
%Việc mô hình hóa vấn đề dưới dạng một bài toán với các mục tiêu, các ràng buộc, cận trên và cận dưới của các biến cũng quan trọng như việc giải quyết vấn đề, bởi mô hình hóa không phù hợp có thể dẫn tới sự không tương thích giữa lời giải và vấn đề, dẫn tới việc phải làm lại toàn bộ quá trình từ đầu. Có hai cách tiếp cận ở bước này. Thứ nhất là ưu tiên việc lựa chọn hơn là tối ưu, nghĩa là đơn giản hóa bài toán thành đơn mục tiêu. Việc này có thể dẫn tới lời giải không đáp ứng được yêu cầu của người dùng như đã đề cập, vì việc xác định nên ưu tiên mục tiêu nào hơn ngay từ đầu không phải là việc dễ dàng trong thực tế. Thứ hai là giải các mục tiêu đồng thời, và để quyền lựa chọn ưu tiên mục tiêu nào hơn cho hệ quyết định xử lý. Cách tiếp cận này phù hợp với thực tế, đồng thời giúp người dùng hiểu rõ hơn về vấn đề đang gặp phải, giúp lựa chọn chính xác và thông minh hơn.


%Các bài toán tối ưu đa mục tiêu có thể được viết dưới dạng công thức cơ bản như sau:
%\begin{equation}
%\begin{multlined}
%minimize 	\{f_{1}(x),f_{2}(x),...,f_{k}(x)\} \\ 
%subject to x \in S
%\end{multlined}
%\end{equation}
 
%\section{Các cách tiếp cận}
\chapter{Tối ưu đa mục tiêu trên cây tổng hợp dữ liệu}
Sự tiến bộ của công nghệ giúp sản xuất các thiết bị cảm biến ngày một hiện đại, chiếm ít không gian, hiệu năng cao, giá thành rẻ, hỗ trợ triển khai số lượng lớn trên cùng một không gian. Đi liền với đó là khó khăn trong việc tận dụng hiệu quả các nút cảm biến khi năng lượng, khả năng tính toán, bộ nhớ vẫn còn hạn chế. Tổng hợp dữ liệu được nghiên cứu nhằm giải quyết khó khăn này. Nhiệm vụ này được định nghĩa như một quy trình toàn cục bao gồm việc tập trung và điều hướng thông tin thông qua các lớp mạng, xử lý dữ liệu tại các nút trung gian nhằm giảm thiểu việc tiêu thụ năng lượng, qua đó duy trì thời gian sống toàn mạng \cite{fasolo2007network}.


Các tác vụ trong tổng hợp dữ liệu có thể kể đến: giao tiếp thông tin giữa các nút cảm biến, tính toán, tổng hợp tại một nút và lưu trữ dữ liệu. Trong thực tế, việc giao tiếp thông tin giữa các nút cảm biến thường tiêu hao nhiều năng lượng nhất. Tác vụ này bao gồm rất nhiều phương pháp điều hướng gói tin trong mạng, hỗ trợ cho việc tổng hợp dữ liệu từ nhiều nguồn và truyền tải tới một (hoặc nhiều) đích đến. Một số giao thức hỗ trợ giao tiếp thông tin trong mạng có thể kể đến: giao thức dạng cây, giao thức dạng cụm, giao thức đa đường và giao thức lai.


Giao thức dạng cây là phương thức cổ điển để tổng hợp dữ liệu trong mạng cảm biến không dây, trong đó các nút cảm biến được tổ chức theo cấu trúc phân cấp và kế thừa. Trước hết, một cây với trạm tiếp nhận thông tin là nút gốc được xây dựng. Sau đó việc truyền và nhận thông tin được thực hiện tuần tự theo từng cấp, từ lá tới gốc. Giao thức này phù hợp để áp dụng trong các bài toán tối ưu hóa các hàm tổng hợp dữ liệu và và quản lý năng lượng \cite{fasolo2007network}. 


Trong thực tế, không phải lúc nào tất cả các nút được triển khai cũng truyền tải dữ liệu, chỉ một số các nút được chỉ định là các nút cảm biến có nhiệm vụ thu thập dữ liệu xung quanh và truyền lên các cấp cao hơn. Bài toán lúc này trở thành bài toán cây Steiner: tìm cây khung nhỏ nhất chứa tập con từ tập các đỉnh cho trước. Bài toán này có độ khó NP-hoàn chỉnh \cite{karp1972reducibility}.


Chương này tập trung vào bài toán tối ưu hóa đa mục tiêu trên mạng cảm biến không dây sử dụng giao thức cây để tổng hợp dữ liệu. Các phần sau của chương này có nhiệm vụ làm rõ các mục tiêu trong bài toán đề cập ở \cite{lu2014construction} và các nghiên cứu liên quan.


Để thuận tiện cho các công thức được đề cập bên dưới, bài toán sẽ được phát biểu lại như sau.

\textbf{Đầu vào}: 
\begin{itemize}
	\item Tập các nút được triển khai trên mạng N. Các nút được mô hình hóa bằng tọa độ không gian 3 chiều (x,y,z).
	\item Tập các nút cảm biến và trạm trung tâm M (tập con của N).
\end{itemize}

\textbf{Đầu ra}: Cây khung nhỏ nhất chứa tất cả các nút thuộc M, có thể chứa hoặc không chứa các nút khác. Các nút ngoài tập M xuất hiện trong cây được gọi là nút Steiner. Tập chứa các nút này gọi là tập S.

\textbf{Ràng buộc}:
\begin{itemize}
	\item Khoảng cách giữa các nút trong cây không lớn hơn r (bán kính truyền thông của các nút cảm biến).
	\item Tất cả các nút lá trong cây đều thuộc M.
\end{itemize}

\section{Mô hình năng lượng}
Mô hình mất mát năng lượng ở \cite{heinzelman2002application} được áo dụng. Công thức tính toán năng lượng nhận và truyền dữ liệu có dạng như sau:
\begin{equation}
E_{RX} = k \times E_{elec}.
\end{equation}

\begin{equation}
E_{TX} = 
\begin{cases}
k \times E_{elec} + k \times \epsilon_{fs} \times d^2,  & d < d_0\\
k \times E_{elec} + k \times \epsilon_{mp} \times d^4, & d \geq d_0.\\
\end{cases}
\end{equation}

d là khoảng cách thực tế giữa các nút. $epsilon_{fs}$ và $epsilon_{mp}$ là các hằng số để tính toán năng lượng tiêu thụ khi truyền gói tin trong khoảng cách ngắn và khoảng cách dài.

Năng lượng tổng hợp dữ liệu $E_{DA}$ tại các nút là một hằng số.

\section{Tổng năng lượng tiêu thụ}
\subsection{Mô tả}
Vấn đề lớn nhất đối với các mạng cảm biến không dây là việc suy hao năng lượng của các nút cảm biến. Bởi các nút cảm biến dự trữ rất ít năng lượng, việc áp dụng các thuật toán nhằm tối thiểu hóa năng lượng tiêu thụ trong quá trình vận hành là vô cùng cần thiết. Năng lượng tiêu thụ của cây tổng hợp dữ liệu có thể được tính bằng tổng năng lượng trên tất cả các nút.

\begin{equation}
f_1(x) = \sum_{i=1}^{M + S} (E^i_{TX} + \sum_{j=1}^{C_{num_i}} (E_{RX}^j + E_{DA}^j))
\end{equation}

$C_{num_i}$ là tất các nút con của nút thứ i trong cây tổng hợp dữ liệu. Năng lượng tiêu thụ trên mỗi nút sẽ bằng tổng của năng lượng truyền gói tin cho nút cha của nó và năng lượng tổng hợp (bao gồm năng lượng nhận gói tin và năng lượng tổng hợp dữ liệu) từ tất cả các nút con.
\subsection{Nghiên cứu liên quan}
Trong cây tổng hợp dữ liệu, các nút trung gian đóng vai trò là nơi tổng hợp dữ liệu nhằm hạn chế hao tổn nếu phải truyền lại gói tin. Tuy đi kèm với đó là thời gian để nhận gói tin từ tất cả các nút con, và mất mát năng lượng để tổng hợp, nhưng thời gian và năng lượng hao phí này là nhỏ nếu so với việc phải truyền lại gói tin khi không tổng hợp trước. Quan sát này cho thấy cần phải cân nhắc lựa chọn nút nào là nút cha.


Một quan sát quan trọng khác là khoảng cách ảnh hưởng trực tiếp tới năng lượng cần cấp phát để truyền gói tin. Nói cách khác, các nút ở gần (nếu còn đủ năng lượng) nên được ưu tiên làm nút cha để tối thiểu hóa năng lượng tiêu thụ. Quan sát này là tiền đề cho thuật toán đề xuất trong \cite{eskandari2008energy}. Trong đây, tác giả đề cập tới việc sử dụng ba tiêu chí với độ ưu tiên giảm dần để lựa chọn nút cha cho các nút như sau: năng lượng còn lại, khoảng cách truyền và số lượng nút con tối đa. Hai tham số đầu tiên đồng thời là tiêu chí lựa chọn nút cha của các thuật toán đề xuất trong \cite{lee2005energy} và \cite{lee2005lpt}. Tham số thứ ba được đề xuất để tránh tình trạng một nút có quá nhiều nút con dẫn tới mất mát năng lượng quá nhanh, hỗ trợ cho việc duy trì thời gian sống toàn mạng.

\section{Thời gian sống của mạng}
\subsection{Mô tả}
Một trong những mục tiêu khi triển khai mạng cảm biến không dây là duy trì thời gian sống toàn mạng. Bởi đặc điểm gồ ghề, khó tiếp cận của một số địa hình khi triển khai gây khó khăn cho việc thay thế, khắc phục sự cố như hết pin, tai nạn hay phá hoại từ bên ngoài mà việc duy trì tính ổn định là vô cùng cần thiết. Tùy thuộc vào yêu cầu thực tế mà định nghĩa thời gian sống của mạng cảm biến thay đổi: thời gian mà mạng cảm biến vẫn còn duy trì việc giao tiếp như thông thường, thời gian mà mạng cảm biến vẫn còn bao quát một không gian, thời gian từ khi bắt đầu tới khi việc thu thập dữ liệu lần đầu thất bại. Khi một nút cảm biến tiêu thụ hết năng lượng thì cây tổng hợp dữ liệu phải tự điều chỉnh lại. Thời gian sống của mạng, do đó, có thể tính toán qua thời gian sống tối thiểu của một nút trên cây.

\begin{equation}
f_2(x) = \frac{1}{min_{i \in M+S}  L^i}
\end{equation}

với
\begin{equation}
L^i = \frac{E^i_{residual}}{E^i_{TX} + \sum_{j=1}^{C_{num_i}} (E_{RX}^j + E_{DA}^j)}
\end{equation}
$E^i_{residual}$ là năng lượng còn lại của nút thứ i.
\subsection{Nghiên cứu liên quan}
Một trong những lý do chính dẫn tới việc tiêu hao năng lượng quá nhanh (dẫn tới việc nút "chết" trong mạng cảm biến) là do sự mất cân bằng trong việc tổng hợp và giao tiếp thông tin giữa các nút (một nút phải tổng hợp từ quá nhiều nút hoặc truyền dữ liệu tới một nút rất xa). Thuật toán tham lam trong \cite{liu2019heuristic} đề xuất một giải pháp đơn giản cho việc mất cân bằng giữa các nút trong mạng. Giải pháp trong bài báo trước hết là xây dựng một cây khung nhỏ nhất để đảm bảo khoảng cách giữa các nút không quá lớn, sau đó cân nhắc lựa chọn trong lân cận một nút còn lại nhiều năng lượng nhất là nút cha. Để điều chỉnh cho phù hợp với mô hình ban đầu, chúng ta sẽ loại bỏ các nút lá không phải là các nút cảm biến để tránh tình trạng dư thừa không cần thiết.


Trong số các thuật toán điều hướng theo mô hình phân cấp, mô hình Phân cấp các cụm thích nghi với năng lượng thấp (Low Energy Adaptive Cluster Hierarchy - LEACH) là một mô hình vô cùng nổi tiếng \cite{heinzelman2000energy}. Trong đó, các nút cảm biến sẽ được phân làm các cụm phụ thuộc vào mức độ mạnh/yếu của tín hiệu nhận và lựa chọn một nút làm nút điều hướng của cụm đó. Việc này sẽ giúp tiết kiệm năng lượng một cách đáng kể bởi việc truyền thông tin chỉ được thực hiện bởi nút điều hướng chứ không phải tất cả các nút cảm biến. Việc lựa chọn nút nào làm nút đầu cũng sẽ được thay đổi liên tục để phù hợp với mục tiêu kéo dài thời gian sống toàn mạng.


Có một số giải thuật cải tiến từ giải pháp trên, hầu hết là cách lựa chọn nút điều hướng sao cho phù hợp để duy trì sự cân bằng trong tiêu thụ năng lượng, qua đó kéo dài thời gian sống toàn mạng. \cite{bakaraniya2013k} đề xuất việc lựa chọn nút điều hướng và hình thành các cụm bằng thuật toán K-medoids, trong đó nút điều hướng là nút gần tâm cụm nhất tính toán theo khoảng cách Euclide. Trong khi đó \cite{arumugam2015ee} lại đề xuất việc sử dụng nút còn nhiều năng lượng nhất để làm nút điều hướng, và việc lựa chọn sẽ được thực hiện theo mỗi một chu kỳ truyền thông tin.

\section{Độ trễ khi tổng hợp dữ liệu}
\subsection{Mô tả}
Nhược điểm khi sử dụng mô hình tổng hợp dữ liệu dạng cây là thời gian tổng hợp dữ liệu lớn, gây chậm trễ trong quá trình xử lý thông tin. Theo mô hình được đề xuất, các nút trung gian không chỉ có vai trò chuyển phát dữ liệu lên nút cha mà còn phải tổng hợp dữ liệu từ các nút con. Một nút cũng chỉ có thể bắt đầu chuyển dữ liệu khi đã tổng hợp dữ liệu từ tất cả các nút con. Một thực tể rõ ràng là sự phân phối không đồng đều giữa các nút con sẽ dẫn tới tình trạng chờ đợi không cần thiết ở các nút còn lại. Các cách giải quyết nhược điểm này sẽ được bàn kĩ hơn ở phần bên dưới.

Từ định nghĩa bên trên, công thức tính độ trễ cho toàn mạng sẽ tương ứng với tổng độ trễ trên từng lớp, và độ trễ trên mỗi lớp sẽ là độ trễ lớn nhất của một nút ở lớp đó.

\begin{equation}
f_3(x) = \sum_{i=1}^h lt(i-1) = \sum_{i=1}^h CN_{i-1} * \frac{Max(data_i)}{rate_i}
\end{equation}
$CN_{i-1}$ là số lượng nút con lớn nhất ứng với một nút ở lớp thứ $i-1$,  $Max(data_i)$ và $rate_i$ là kích thước lớn nhất mà dữ liệu có thể truyền và tốc độ truyền ở lớp thứ $i$.
\subsection{Nghiên cứu liên quan}
Trong \cite{youssef2007intelligent}, tác giả đã đề cập tới một phương pháp mang tính lý thuyết, sử dụng các nút cảm biến di chuyển được đóng vai trò như một cổng giao tiếp (gateway) để tổng hợp dữ liệu và chuyển tới các nút trung gian. Một cách dễ hình dung, các nút cảm biến sẽ được nhóm vào thành các cụm, và các cụm sẽ liên lạc với nhau thông qua các cổng giao tiếp. Số lượng cụm càng nhiều thì khả năng tổng hợp dữ liệu càng tốt (do số lượng nút ứng với từng cụm sẽ ít đi), tuy nhiên thời gian di chuyển từ nút lá tới trạm trung tâm lại tăng lên do gói tin cần đi qua nhiều trung gian. Giải thuật di truyền tối ưu hóa bước nhảy (GAHO - Genetic Algorithm for Hop count Optimization) được đề xuất trong \cite{youssef2007intelligent} được đề xuất nhằm giảm thiểu khoảng cách truyền này.


Cũng sử dụng cách phân chia địa hình ra từng khu vực nhỏ, đề xuất trong \cite{wang2012minimizing} chia địa hình thành từng ô vuông với kích thước bằng nhau. Thuật toán phân cụm và chọn các nút điều hướng trong mỗi cụm chia thành các bước, bước sau sẽ là tổng hợp nhiều ô nhỏ từ bước trước thành một ô lớn hơn, cho tới khi toàn bộ mạng được liên kết với nhau thành một cây tổng hợp dữ liệu. Nhờ việc phân chia địa hình thành các ô vuông, khoảng cách từ các nút trong một ô tới nút điều hướng của cụm luôn được chặn trên (kích thước đường chéo của ô vuông đó), thuật toán tính được độ trễ tối đa dựa vào khoảng cách lớn nhất mà các nút trong mạng có thể truyền được.


Một phương pháp khác để phân chia cụm được đề xuất trong \cite{xu2010delay}. Thuật toán chia làm hai giai đoạn, giai đoạn thứ nhất là phân chia ra thành các nút mạnh (dominators) và các nút yếu (dominatees), sau đó sử dụng các nút mạnh để truyền dữ liệu tới trạm xử lý trung tâm, các nút yếu thì kết nối với các nút mạnh. Độ mạnh của từng nút được tính bằng khoảng cách từ nút đó tới trạm xử lý, nút càng gần thì càng mạnh, và cách tìm ra các nút mạnh sử dụng thuật toán duyệt theo chiều rộng (BFS - Breath First Search).

\section{Độ nhiễu trong giao tiếp}
\subsection{Mô tả}
Các nút trong mạng cảm biến sử dụng kết nối không dây để giao tiếp, hệ quả trực tiếp là phát sinh vấn đề nhiễu trong truyền và nhận dữ liệu. Vấn đề này xuất hiện khi trong bán kính giao tiếp của hai nút đang kết nối với nhau xuất hiện tín hiệu từ một nút thứ ba, gây xung đột trong quá trình truyền tin (vấn đề nút ẩn - hidden node problem). Xung đột xảy ra bắt các nút cảm biến phải truyền lại gói tin, gây tổn hao năng lượng và ảnh hưởng tới chất lượng tổng hợp. Giảm thiểu số lượng nút ảnh hương trong phạm vi kết nối giữa hai nút, do đó là một trong những mục tiêu cần tối ưu khi thiết kế mạng cảm biến không dây. Công thức được suy ra trực tiếp từ định nghĩa này:

\begin{equation}
f_4(x) = Max|Cov_e|
\end{equation}

với $$Cov_e = \{n \in V | \text{n là số lượng nút nằm trong D(x,$|x,y|$) hoặc D(y,$|y,x|$)} \}$$
\subsection{Nghiên cứu liên quan}
Nghiên cứu trong \cite{lou2011minimizing} đề xuất một giải pháp xây dựng cây tổng hợp dữ liệu giúp tối thiểu hóa độ nhiễu trung bình, qua đó tìm cận trên cho bài toán tối thiểu hóa độ nhiễu tối đa. Sử dụng cách tiếp cận với các nút phân bố trên địa hình 1 chiều (các nút xếp thẳng hàng trên một đường thẳng), sau đó giải quyết trên địa hình 2 chiều bằng cách kẻ các đường thằng đi qua các nút cảm biến, và xây dựng kết nối giữa các nút sao cho độ nhiễu không vượt quá số lượng kết nối tối đa của một nút.


Cũng sử dụng các công thức của hình học không gian, nghiên cứu trong \cite{jang2010applications} phân chia địa hình ra thành từng cụm và lựa chọn đường đi tối ưu trong mỗi cụm. Có ba bước chính được sử dụng. Thứ nhất là mô hình Voronoi (Voronoi diagram) để tìm kiếm lân cận của các nút. Thứ hai là thuật toán tam giác hóa Delaunay (Delauney triangulation) để giảm thiểu độ dài kết nối giữa các nút (từ đó giúp giảm thiểu độ nhiễu trong quá trình truyền tin). Cuối cùng là sử dụng độ lệch chuẩn trong bán kính truyền như một tiêu chí để cắt giảm các kết nối có khoảng cách lớn. Cụ thể thì các cảm biến sẽ được đánh giá mức độ qua các kết nối của chúng, và tổng hợp mức độ từ hai đầu của một kết nối sẽ cho ra mức độ ưu tiên của kết nối đó. Các kết nối có mức độ ưu tiên cao sẽ bị loại bỏ.


Nhóm tác giả trong \cite{burkhart2004does} đề xuất giải thuật Xây dựng rừng với độ nhiễu thấp (LIFE - Low Interference Forest Establisher). Mạng cảm biến không dây được mô hình thành một tập các cạnh sắp xếp theo thứ tự tăng dần của khoảng cách. Các cạnh được thêm vào khi hai nút cảm biến ứng với cạnh đó chưa được kết nối trong mạng. Làm liên tục như vậy cho đến khi xây dựng được một cây hoàn chỉnh.
